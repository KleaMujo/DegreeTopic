<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="/assets/vendor/jquery/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body {
            font-family: 'Nunito', sans-serif;
            background-color: #f5f5f5;
            margin: 0;
            padding: 0;
        }
        .main-content {
            display: flex;
        }
        .dashboard {
            flex: 1;
            padding: 30px;
        }
        .summary-cards {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        .summary-cards .card {
            flex: 1 1 200px;
            padding: 20px;
            border: none;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            background-color: #fff;
            text-align: center;
            font-weight: bold;
        }
        .charts {
            display: flex;
            gap: 40px;
            flex-wrap: wrap;
        }
        .chart {
            flex: 1 1 400px;
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        }
        .recent-activities table {
            width: 100%;
            margin-top: 20px;
            background: #fff;
            border-collapse: collapse;
        }
        .recent-activities th, .recent-activities td {
            padding: 12px;
            border: 1px solid #ddd;
        }
        .quick-actions {
            margin-top: 30px;
        }
        .quick-actions button {
            margin-right: 15px;
        }
    </style>
</head>
<body>
<header class="header">

    <div class="navbar">
        <div class="user-dropdown">
            <div class="user-avatar">A</div>
            <div class="dropdown-content">
                <a href="#"><i class="fas fa-user me-2"></i> Profile</a>
                <a href="#"><i class="fas fa-cog me-2"></i> Settings</a>
                <a href="/logout"><i class="fas fa-sign-out-alt me-2"></i> Log Out</a>
            </div>
        </div>
    </div>
</header>
<!-- Main Content Container -->
<div class="main-container" style="display:flex;">
    <div th:replace="/Teacher/sidebarTeacher.html"></div>
    <div class="dashboard">

        <!-- Summary Cards -->
        <div class="summary-cards" style="display: flex; gap: 20px; margin-bottom: 30px;">
            <div class="card" style="flex: 1; padding: 20px; background: #ffe0cc; border-radius: 12px; text-align: center;">
                <div style="font-size: 18px;">Total Topics</div>
                <div style="font-size: 24px; font-weight: bold;" th:text="${totalTopics}"></div>
            </div>
            <div class="card" style="flex: 1; padding: 20px; background: #dcdcff; border-radius: 12px; text-align: center;">
                <div style="font-size: 18px;">Assigned Students</div>
                <div style="font-size: 24px; font-weight: bold;" th:text="${assignedStudents}"></div>
            </div>
            <div class="card" style="flex: 1; padding: 20px; background: #c8f0f2; border-radius: 12px; text-align: center;">
                <div style="font-size: 18px;">Assignments</div>
                <div style="font-size: 24px; font-weight: bold;" th:text="${totalAssignments}"></div>
            </div>
        </div>

        <!-- Charts Section -->
        <div class="charts" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
            <div class="chart-card" style="background: #fff; border-radius: 12px; padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                <h5>Topics Status (Pie)</h5>
                <canvas id="topicsStatusChart"></canvas>
            </div>
            <div class="chart-card" style="background: #fff; border-radius: 12px; padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                <h5>Students per Topic (Bar)</h5>
                <canvas id="studentsPerTopicChart"></canvas>
            </div>
            <div class="chart-card" style="background: #fff; border-radius: 12px; padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                <h5>Topics Status (Donut)</h5>
                <canvas id="topicsDonutChart"></canvas>
            </div>
        </div>

        <!-- Recent Activities -->
        <div class="recent-activities" style="margin-top: 40px;">
            <h4>Recent Activities</h4>
            <table style="width: 100%; border-collapse: collapse; background: #fff; border-radius: 8px; overflow: hidden;">
                <thead>
                <tr style="background: #f5f5f5;">
                    <th style="padding: 10px;">Activity</th>
                    <th style="padding: 10px;">Date</th>
                    <th style="padding: 10px;">Details</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="activity : ${recentActivities}">
                    <td colspan="3" th:text="${activity}" style="padding: 10px;"></td>
                </tr>
                </tbody>
            </table>
        </div>

        <!-- Quick Actions -->
        <div class="quick-actions" style="margin-top: 30px; display: flex; gap: 15px;">
            <button class="btn btn-primary" onclick="location.href='/addDegreeTopic'">Add Topic</button>
            <button class="btn btn-secondary" onclick="location.href='/myDegrees'">All Topics</button>
            <button class="btn btn-info" onclick="location.href='/viewNotificationsProfessor'">Notifications</button>
        </div>

    </div>

</div>

<script>
    // Example Chart Data (to be populated dynamically using Thymeleaf)
    const topicStatusMap = /*[[${topicStatusMap}]]*/ {};
    const studentsPerTopic = /*[[${studentsPerTopic}]]*/ {};

    // Pie Chart
    new Chart(document.getElementById('topicsStatusChart'), {
        type: 'pie',
        data: {
            labels: Object.keys(topicStatusMap),
            datasets: [{
                label: 'Topics Status',
                data: Object.values(topicStatusMap),
                backgroundColor: ['#007bff', '#ffc107', '#dc3545']
            }]
        }
    });

    // Donut Chart
    new Chart(document.getElementById('topicsDonutChart'), {
        type: 'doughnut',
        data: {
            labels: Object.keys(topicStatusMap),
            datasets: [{
                label: 'Topic Distribution',
                data: Object.values(topicStatusMap),
                backgroundColor: ['#17a2b8', '#28a745', '#fd7e14']
            }]
        }
    });

    // Bar Chart
    new Chart(document.getElementById('studentsPerTopicChart'), {
        type: 'bar',
        data: {
            labels: Object.keys(studentsPerTopic),
            datasets: [{
                label: 'Students per Topic',
                data: Object.values(studentsPerTopic),
                backgroundColor: '#6610f2'
            }]
        },
        options: {
            responsive: true,
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });
</script>
</body>
</html>
